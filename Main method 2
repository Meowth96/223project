import java.util.Scanner;
import java.util.Arrays;
import java.util.Collections;
public class Main2 {

public static void main(String[] args) {
   
   int playerDiscard;
   int CPUDiscard;     
   int cPile,pPile;
   int cPlayed,pPlayed;
   int totalCardsPlayedThisWar;
   int cardCount;
   int winner;
   
   Scanner keyboard = new Scanner(System.in);
               
   Boolean cont;
   cont=true; //at the end of a round set to false if the player does not want to continue
        
   while (cont == true){
        
        Deck deck = new Deck();
        deck.shuffleDeck();
        
        Pile playerHand = new Pile();//players hand
        Pile CPUHand = new Pile();//the CPUs hand
        Card playerCard;
        Card CPUCard;

        // deal all the cards in the deck
        while (deck.getCardsInDeck()>0){
            playerHand.addCard(deck.drawDeck());
            CPUHand.addCard(deck.drawDeck());
            }        
        
        //Initialize the discard counters to zero, these indicate the score of each player
        playerDiscard=0;
        CPUDiscard=0;
        
        //Initialize card counter to zero; It keeps track of total cards played
        cardCount = 0;
        
        //drawPoints is used to determine score in case of a draw, if there is a draw it is set to half the cards played in the war
          int drawPoints = 0;
          
        
         boolean nextCard = true;
        //This loop keeps game play going as long as each player has one card
        while (cardCount < 52 && nextCard == true)
            {   //compare player and cpu cards
            
                        
            
                playerCard = playerHand.playCard();
                cardCount++;
                CPUCard = CPUHand.playCard();
                cardCount++;
                
                System.out.println("Player plays a " + playerCard.toString());
                System.out.println("CPU plays a " + CPUCard.toString());
            
                if (playerCard.getValue() > CPUCard.getValue()) {
                    //player wins this round
                    playerDiscard+=2;
                    System.out.println("Player wins this battle!");
                  } 
                else if (playerCard.getValue() < CPUCard.getValue()) {
                    //CPU wins this round
                    CPUDiscard+=2;
                    System.out.println("CPU wins this battle!");
                   }
                //cards are the same
                else {     
                           System.out.println("War!!");
                           pPile = playerHand.getCardsInPile();
                           cPile = CPUHand.getCardsInPile();
                           War2 w = new War2();
                           winner = w.War(playerHand, CPUHand);
                           
                           pPlayed = pPile - playerHand.getCardsInPile();
                           cPlayed = cPile - CPUHand.getCardsInPile();
                           totalCardsPlayedThisWar = pPlayed + cPlayed;
                           cardCount = cardCount + totalCardsPlayedThisWar;

                           
                           if (winner==1)
                                  {playerDiscard+=totalCardsPlayedThisWar+2;
                                   System.out.println("Player won this war!");
                                   }
                            else if(winner==2)
                                 {CPUDiscard+=totalCardsPlayedThisWar+2;
                                  System.out.println("CPU won this war!");
                                  }
                            else
                                 {System.out.println("War was a draw.");
                                  drawPoints = (totalCardsPlayedThisWar+2)/2;
                                  playerDiscard = playerDiscard + drawPoints;
                                  CPUDiscard = CPUDiscard + drawPoints;
                                 } 
                                                     }//else war
                   System.out.println("");   
                   
                   //control play of next card from console
                   System.out.println("Please press the n key to play next card or any other key to quit.");
                   String s2 = keyboard.next();
                   if (s2.equals("n")) 
                        nextCard = true;
                   else
                        nextCard = false;


                   
                   
                                        
             }//end of while cardsInPile
         
             
        System.out.println("The Player scored "+playerDiscard + " and the CPU scored " + CPUDiscard);
        
        if (playerDiscard > CPUDiscard)
            System.out.println("The Player wins!!");
        else if (CPUDiscard > playerDiscard)
            System.out.println("The CPU wins!!");
        else
            System.out.println("It is a tie!");
                    
        System.out.println("Please press the c key to continue play another round or any other key to quit.");
        String s1 = keyboard.next();
        if (s1.equals("c")) 
            cont = true;
        else
            cont = false;
        }
     }
               
   }
